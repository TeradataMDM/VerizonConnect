BTEQ 16.10.00.01 Thu May 10 06:26:51 2018 PID: 5244
 
+---------+---------+---------+---------+---------+---------+---------+----
/***********************************************************************************************************
SCRIPT:              updateStageTargetAddrIds.btqt 
DESCRIPTION:         This script update stage persona address table with target address ids and match type of each address id
DEPENDENCY:           
INPUT:               SURVIVORSHIP INTERIM Tables 
OUTPUT:              UPDATE STAGE PRSNA_ADDR TABLE, TGT_ADDR_ID and INSERT_UPDATE_FLAG ATTRIBUTES FROM SURVIVORSHIP INTERIM Tables 
ERRORS:
SPECIAL INSTRUCTIONS:

CHANGE LOG:
VERSION              DATE                 AUTHOR                          CHANGES
1.00                05/08/2018           CA186004                        CREATED
***********************************************************************************************************/
.LOGON 10.25.132.9/MDM41,

 *** Logon successfully completed.
 *** Teradata Database Release is 16.20q.00.10                  
 *** Teradata Database Version is 16.20q.00.10                    
 *** Transaction Semantics are BTET.
 *** Session Character Set Name is 'ASCII'.
 
 *** Total elapsed time was 1 second.
 
+---------+---------+---------+---------+---------+---------+---------+----
--.SET ERROROUT STDOUT;
--.SET SESSION CHARSET 'UTF8';

--------------------------------------------------------------------------------------------------------------------
-- UPDATE STAGE PRSNA_ADDR TABLE, TGT_ADDR_ID and INSERT_UPDATE_FLAG ATTRIBUTES FROM SURVIVORSHIP INTERIM Tables --
--------------------------------------------------------------------------------------------------------------------
UPDATE TRG
FROM MDM41_STG.PRSNA_ADDR_STG TRG,
(
 SELECT TRGT_ADDR_ID, PRSNA_ID, STREET_ADDR_RQST_ID as ADDR_RQST_ID, INSER
T_UPDATE_FLAG, ADDR_TYPE_CD FROM MDM41_STG.STREET_ADDR_XREF_FWD
 UNION
 SELECT TRGT_ADDR_ID, PRSNA_ID, TEL_NUM_RQST_ID as ADDR_RQST_ID, INSERT_UP
DATE_FLAG, ADDR_TYPE_CD FROM MDM41_STG.TEL_NUM_XREF_FWD
 UNION 
 SELECT TRGT_ADDR_ID, PRSNA_ID, ELEC_ADDR_RQST_ID as ADDR_RQST_ID, INSERT_
UPDATE_FLAG, ADDR_TYPE_CD FROM MDM41_STG.ELEC_ADDR_XREF_FWD
) SRC
SET TGT_ADDR_ID = SRC.TRGT_ADDR_ID, INSERT_UPDATE_FLAG=SRC.INSERT_UPDATE_F
LAG
WHERE TRG.PRSNA_ID = SRC.PRSNA_ID
AND   TRG.ADDR_RQST_ID = SRC.ADDR_RQST_ID
AND   TRG.ADDR_TYPE_CD = SRC.ADDR_TYPE_CD
;

 *** Update completed. 7 rows changed. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+----

.IF ERRORLEVEL > 0 THEN .GOTO EXIT;
+---------+---------+---------+---------+---------+---------+---------+----

.LABEL EXIT
+---------+---------+---------+---------+---------+---------+---------+----

.IF ERRORLEVEL <= 4 THEN .GOTO WARN;
.GOTO WARN;
+---------+---------+---------+---------+---------+---------+---------+----
.IF ERRORLEVEL > 4 THEN .GOTO ERR ;
 *** Skipped.
+---------+---------+---------+---------+---------+---------+---------+----

.LABEL WARN
+---------+---------+---------+---------+---------+---------+---------+----
.QUIT 0
 *** You are now logged off from the DBC.
 *** Exiting BTEQ...
 *** RC (return code) = 0 
